spring.application.name=spring-user

# Supabase PostgreSQL Connection (Direct - puerto 5432)
spring.datasource.url=jdbc:postgresql://db.kkjjgvqqzxothhojvzss.supabase.co:5432/postgres?sslmode=require&prepareThreshold=0&socketTimeout=60&connectTimeout=60
spring.datasource.username=postgres
spring.datasource.password=LOgineosnash18

# HikariCP - Configuración del pool de conexiones para Supabase
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000

# IMPORTANTE: Usar 'none' para evitar que Hibernate modifique las tablas existentes en Supabase
spring.jpa.hibernate.ddl-auto=none
spring.jpa.properties.hibernate.jdbc.batch_size=0
spring.jpa.open-in-view=false

# Dialecto de PostgreSQL - REQUERIDO cuando no hay conexión a la BD
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# Configuración adicional para PostgreSQL/Supabase
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Deshabilitar inicialización lazy para evitar errores de conexión al inicio
spring.jpa.defer-datasource-initialization=true
spring.sql.init.mode=never


# JWT Resource Server configuration (Supabase)
# El issuer real de Supabase es /auth/v1
# Supabase usa HS256 (algoritmo simétrico) con JWT Secret
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://kkjjgvqqzxothhojvzss.supabase.co/auth/v1
# JWT Secret de Supabase - Obtenerlo del dashboard de Supabase > Settings > API > JWT Secret
# Por ahora, intentaremos usar el JWK Set URI primero, y si falla, usaremos HS256
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=https://kkjjgvqqzxothhojvzss.supabase.co/auth/v1/.well-known/jwks.json
# JWT Secret para HS256 (Legacy JWT Secret de Supabase)
# Obtenerlo de: Supabase Dashboard > Settings > API > JWT Keys > Legacy JWT Secret
# Si no está configurado, se usará el anon key como fallback
supabase.jwt.secret=${SUPABASE_JWT_SECRET:esP6j1fWPEAiPxMHwVIpRrOFPqgS2JNSMeb85O4xwzitoWqDgePgW2lmp1GpMcNOM7arNl3pHeHTpU/oekwRMw==}
# Anon key de Supabase (usado como fallback para HS256)
supabase.anon.key=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtrampndnFxenhvdGhob2p2enNzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyNTkyNjQsImV4cCI6MjA3OTgzNTI2NH0.DR-bCWKczVoYuXbAFS_LWewJEb41E84AvAOVd7T_8sA

# Server configuration
server.port=8080
logging.level.org.springframework.security=DEBUG


# Allowed institutional email domain
app.allowed-domain=tecsup.edu.pe

# Upload directory for images
app.upload.dir=uploads
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=20MB

# DeepSeek Configuration
# Configura tu API key de DeepSeek como variable de entorno: DEEPSEEK_API_KEY
deepseek.api.key=${DEEPSEEK_API_KEY:sk-e3d1beec423643f094bbb65a4c653ff0}
deepseek.api.url=https://api.deepseek.com/v1/chat/completions

# Placa API Configuration
# Username para la API de búsqueda de placas de Perú
placa.api.username=${PLACA_API_USERNAME:jhon123}
placa.api.url=https://www.placaapi.pe/api/reg.asmx



